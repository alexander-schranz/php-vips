<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>php-vips by jcupitt</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">php-vips</h1>
      <h2 class="project-tagline">php binding for libvips</h2>
      <a href="https://github.com/libvips/php-vips" class="btn">View on GitHub</a>
    </section>

    <section class="main-content">
      <h1>
<a id="high-level-php-binding-for-libvips" class="anchor" href="#high-level-php-binding-for-libvips" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>High-level PHP binding for libvips</h1>

<p><code>php-vips</code> is a binding for <a href="https://github.com/libvips/libvips">libvips</a> for
PHP 7. </p>

<p>libvips is fast and needs little memory. The <a href="https://github.com/jcupitt/php-vips-bench"><code>vips-php-bench</code></a> repository tests
<code>php-vips</code> against <code>imagick</code> and <code>gd</code>. On that test, and on my laptop,
<code>php-vips</code> is around four times faster than <code>imagick</code> and needs 10 times less
memory. </p>

<p>Programs that use libvips don't manipulate images directly, instead they
create pipelines of image processing operations starting from a source
image. When the pipe is connected to a destination, the whole pipeline
executes at once and in parallel, streaming the image from source to
destination in a set of small fragments.</p>

<p>This module builds upon the <code>vips</code> PHP extension, see:</p>

<p><a
  href="https://github.com/libvips/php-vips-ext">https://github.com/libvips/php-vips-ext</a></p>

<p>You'll need to install that first. It's tested on Linux and macOS --- 
Windows would need some work, but should be possible.  </p>

<h3>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example</h3>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">#!/usr/bin/env php</span></span>
<span class="pl-s1"><span class="pl-k">&lt;</span>?<span class="pl-c1">php</span></span>
<span class="pl-s1"><span class="pl-k">require</span> <span class="pl-c1">__DIR__</span> <span class="pl-k">.</span> <span class="pl-s"><span class="pl-pds">'</span>/vendor/autoload.php<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Jcupitt\Vips</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$image</span> <span class="pl-k">=</span> <span class="pl-c1">Vips\</span><span class="pl-c1">Image</span><span class="pl-k">::</span>newFromFile(<span class="pl-smi">$argv</span>[<span class="pl-c1">1</span>]);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>width = <span class="pl-pds">"</span></span>, <span class="pl-smi">$image</span><span class="pl-k">-&gt;</span><span class="pl-smi">width</span>, <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$image</span> <span class="pl-k">=</span> <span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>invert();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>writeToFile(<span class="pl-smi">$argv</span>[<span class="pl-c1">2</span>]);</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>

<p>You'll need this in your <code>composer.json</code>:</p>

<pre><code>    "require": {
            "jcupitt/vips" : "1.0.0"
    }
</code></pre>

<p>And run with:</p>

<pre><code>$ composer install
$ ./try1.php ~/pics/k2.jpg x.tif
</code></pre>

<p>See <code>examples/</code>. We have a <a href="https://libvips.github.io/php-vips/docs/classes/Jcupitt.Vips.Image.html">complete set of formatted API
docs</a>.</p>

<h3>
<a id="introduction-to-the-api" class="anchor" href="#introduction-to-the-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction to the API</h3>

<p>Almost all methods return a new image for the result, so you can chain them.
For example:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$image</span> <span class="pl-k">=</span> <span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>more(<span class="pl-c1">12</span>)<span class="pl-k">-&gt;</span>ifthenelse(<span class="pl-c1">255</span>, <span class="pl-smi">$image</span>);</span></pre></div>

<p>will make a mask of pixels greater than 12, then use the mask to set pixels to
either 255 or the original image.</p>

<p>You use long, double, array and image as parameters. For example:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$image</span> <span class="pl-k">=</span> <span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>add(<span class="pl-c1">2</span>);</span></pre></div>

<p>to add two to every band element, or:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$image</span> <span class="pl-k">=</span> <span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>add([<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>]);</span></pre></div>

<p>to add 1 to the first band, 2 to the second and 3 to the third. Or:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$image</span> <span class="pl-k">=</span> <span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>add(<span class="pl-smi">$image2</span>);</span></pre></div>

<p>to add two images. Or: </p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$image</span> <span class="pl-k">=</span> <span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>add([[<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>], [<span class="pl-c1">4</span>, <span class="pl-c1">5</span>, <span class="pl-c1">6</span>]]);</span></pre></div>

<p>To make a 2 x 3 image from the array, then add that image to the original.</p>

<p>Almost all methods can take an extra final argument: an array of options.
For example:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>writeToFile(<span class="pl-s"><span class="pl-pds">"</span>fred.jpg<span class="pl-pds">"</span></span>, [<span class="pl-s"><span class="pl-pds">"</span>Q<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">90</span>]);</span></pre></div>

<p><code>php-vips</code> comes <a href="https://libvips.github.io/php-vips/docs/classes/Jcupitt.Vips.Image.html">with full API docs</a>. To regenerate these from your sources, type:</p>

<pre><code>$ vendor/bin/phpdoc
</code></pre>

<p>And look in <code>docs/</code>.</p>

<p>There are around 300 operations in the library, see the vips docs for an
introduction:</p>

<p><a href="https://libvips.github.io/libvips">https://libvips.github.io/libvips</a></p>

<h3>
<a id="how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How it works</h3>

<p>The <code>vips</code> extension defines a simple but ugly way to call any libvips
operation from PHP.  It uses libvips' own introspection facilities
and does not depend on anything else (so no gobject-introspection,
for example). It's a fairly short 1,600 lines of C.</p>

<p>This module is a PHP layer over the ugly <code>vips</code> extension that
tries to make a nice interface for programmers. It uses <code>__call()</code> and
<code>__get()</code> to make all libvips operations appear as methods, and all
libvips properties as properties of the PHP <code>Vips\Image</code> class.</p>

<h3>
<a id="test-and-install" class="anchor" href="#test-and-install" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Test and install</h3>

<pre><code>$ phpcs --standard=PSR2 src
$ php ~/packages/php/composer.phar install
$ vendor/bin/phpunit
$ vendor/bin/phpdoc
</code></pre>

<h3>
<a id="regenerate-auto-docs" class="anchor" href="#regenerate-auto-docs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Regenerate auto docs</h3>

<pre><code>$ cd src
$ ../examples/generate_phpdoc.rb
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/libvips/php-vips">php-vips</a> is maintained by <a href="https://github.com/jcupitt">jcupitt</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
